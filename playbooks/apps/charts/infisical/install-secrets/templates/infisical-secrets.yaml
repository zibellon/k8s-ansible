# =============================================================================
# INFISICAL SECRETS
# Required by official Infisical Helm chart (kubeSecretRef: "infisical-secrets")
# =============================================================================

apiVersion: v1
kind: Secret
metadata:
  name: infisical-secrets
  namespace: {{ .Values.namespace }}
type: Opaque
stringData:
  # JWT authentication secret
  AUTH_SECRET: {{ .Values.infisicalSecrets.authSecret | quote }}
  # Data encryption key
  ENCRYPTION_KEY: {{ .Values.infisicalSecrets.encryptionKey | quote }}
  # Site URL for callbacks and links
  SITE_URL: {{ .Values.infisicalSecrets.siteUrl | quote }}
  # PostgreSQL connection string
  DB_CONNECTION_URI: "postgresql://{{ .Values.postgres.username }}:{{ .Values.postgres.password }}@svc-infisical-postgres.{{ .Values.namespace }}.svc.{{ .Values.dnsDomain }}:{{ .Values.postgres.port }}/{{ .Values.postgres.database }}"
  # Redis connection string
  REDIS_URL: "redis://:{{ .Values.redis.password }}@svc-infisical-redis.{{ .Values.namespace }}.svc.{{ .Values.dnsDomain }}:{{ .Values.redis.port }}"

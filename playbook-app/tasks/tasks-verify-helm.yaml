# =============================================================================
# Verify Helm releases in a namespace
# =============================================================================
# Params:
#   - helm_namespace: Namespace to list Helm releases
#   - label_name: Label prefix for task names (optional, default: 'verify-helm')
# =============================================================================

- name: "[{{ label_name | default('verify-helm') }}] Verify Helm releases"
  command: helm list -n {{ helm_namespace }}
  register: helm_list
  changed_when: false
  delegate_to: "{{ master_manager_fact }}"
  run_once: true

- name: "[{{ label_name | default('verify-helm') }}] Print Helm releases"
  debug:
    msg: "{{ helm_list.stdout_lines }}"
  delegate_to: "{{ master_manager_fact }}"
  run_once: true

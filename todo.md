# Что еще не готово

## Обновление
1. Обновление версии Ubuntu (apt dist upgrade ...)
2. Обновление пакетов на серверах (apt update ...)
3. Обновление компонентов, которые ставились через GIT (containerd, runc, cni)
4. Обновление kubelet, kubectl, kubeadm

## Структура установки HELM
Разделить все установки на три шага. Для каждого шага - отдельный helm-chart. Но все три шага в одном playbook
- pre. Вот тут ставим все Network-policy. И мб что-то еще
- install. Вот тут ставим основной компонент. Вот этот helm-chart будет не у всех. Например у cilium его не будет, так как основная установка производится из официального helm.
- post. Вот тут ставим что-то, что ставится только после установки основного компонента (для cilium, в этом шаге ставим CiliumClusterwideNetworkPolicy - можно сделать тол ко после установки crds)

## Что дополнить и доделать
1. Добавить установку olm-v1. Сейчас установка есть только для olm-v0, а проект перешел на новую версию, полность. НО - medik8s не готов к использованию olm-v1
2. medik8s. проверить и дополнить установку + конфигурацию. Расписать про модуль ядра, который находится в blacklist у системных конфигураций, и который надо включать НЕ ЧЕРЕЗ указание файла, а через unit-service, который будет делать modeprobe (при старте системы)
3. Сделать отдельный playbook - для проверки состояния кластера. Все статистики по всему что есть. Как-то так, чтобы можно было его запустить и получить сводку по всем серверам и всем контейнерам и всем компонентам. Что там вообще происходит, все ли работает и так далее
4. gitlab
   1. Протестировать установку + настрйока + создание нужного репозитория для git-ops
   2. вспомнить, какие вообще ADMIN настройки надо делать, чтобы оно работало исправно (там что-то в admin-area надо настроить). Например запрет на регистрацию
5. argocd
   1. Подумать и расписать про настройки argocd через hosts.yaml (что там вообще можно указать ?)
   2. протестировать запуск и настройку
   3. сделать отдельную переменную для установки git-ops.ya
6. Добавить контроль по: убирать taint с control-plane или нет. Типо - хотим запускать что-то на голове или нет. Учесть этот момент в longhorn. Мб на manager будет большой диск, и ему грех простаивать ? Подумать про эту механику. Если там будет taint - то как будут работать остальные компоненты ?
7. Обновить task = tasks-gather-cluster-facts.yaml
   1. Там надо понимать, была ли инициализация кластера на manager | worker nodde ?
8. gitlab-runner: добавить установку и подключение через официальный helm
9. argocd: правила безопасности, чтобы нельзя было никому навредить
10. Добавить установку https://github.com/stakater/Reloader
    1.  перезапуск подов, если configMap | secret - изменились
11. Добавить установку https://docs.goauthentik.io/
    1.  система авторизации и управления доступами
12. Есть playbook
    1.  которые запускаются до инициализации
    2.  которые запускаются после инициализации
    3.  которые должны быть строго с лимитами
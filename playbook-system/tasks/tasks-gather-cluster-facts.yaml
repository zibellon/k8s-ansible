# =============================================================================
# Gather cluster facts on ALL hosts
# =============================================================================
# Sets facts:
#   - master_manager_fact (string)     -- master manager hostname
#   - is_master_manager_exist (bool)   -- master manager found in hosts.yaml
#   - is_cluster_init (bool)           -- cluster initialized and healthy
#   - joined_node_ips (list)           -- IPs of joined nodes
#   - joined_node_hostnames (list)     -- hostnames of joined nodes
#   - is_node_joined (bool)            -- current host is joined to cluster
#
# This task NEVER fails. If something is missing, facts reflect that.
# =============================================================================

# Step 1: Find master manager
- name: Find master manager
  include_tasks: tasks/tasks-find-master-manager.yaml

# Step 2: Check cluster initialization
- name: Check cluster initialization
  include_tasks: tasks/tasks-check-cluster-init.yaml

# Step 3: Check which nodes are joined
- name: Check node join status
  include_tasks: tasks/tasks-check-node-joined.yaml

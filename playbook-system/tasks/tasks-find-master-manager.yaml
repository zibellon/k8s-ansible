# =============================================================================
# Find master manager from hosts.yaml
# =============================================================================
# Sets fact: master_manager_fact
# =============================================================================

- name: Find master manager
  set_fact:
    master_manager_fact: "{{ item }}"
  loop: "{{ groups['managers'] }}"
  when: hostvars[item].is_master | default(false)

- name: Fail if no master manager found
  fail:
    msg: "ERROR: No manager with is_master: true found in hosts.yaml"
  when: master_manager_fact is not defined
  run_once: true
